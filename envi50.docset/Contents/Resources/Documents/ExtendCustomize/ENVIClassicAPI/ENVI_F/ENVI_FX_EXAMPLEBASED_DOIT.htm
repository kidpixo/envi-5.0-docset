<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Programming|Routines|Processing" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-us" xml:lang="en-us" madcap:pathtohelpsystem="../../../../" madcap:helpsystemfilename="ENVIHelp.xml" madcap:searchtype="Stem">
 <!-- saved from url=(0014)about:internet -->
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   ENVI_FX_EXAMPLEBASED_DOIT
  </title>
  <link href="../../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../../Resources/TableStyles/Description.css" rel="stylesheet" />
  <link href="../../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
  <script src="../../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../../ENVIHelp_CSH.htm#ExtendCustomize/ENVIClassicAPI/ENVI_F/ENVI_FX_EXAMPLEBASED_DOIT.htm" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../ProgrammingWithENVI.htm">
    Programming
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../../Routines.htm">
    Routines
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../A/ADAPT_FILT_DOIT.htm">
    Processing
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    ENVI_FX_EXAMPLEBASED_DOIT
   </span>
  </div>
  <h1>
   ENVI_FX_EXAMPLEBASED_DOIT
   <a name="kanchor318">
   </a>
  </h1>
  <p>
   This procedure automates the
   <a href="../../../FindFeatures/FeatureExtraction/Example_Based_Classification.htm">
    Example Based Feature Extraction
   </a>
   workflow, using an imported training data file (
   <code>
    .shp
   </code>
   ).
  </p>
  <p>
   Based on the segmentation options that you specify,
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   will compute spatial, spectral, and texture attributes and will generate the following optional images: segmentation, attribute, rule confidence, and classification.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   This procedure is available for use only if you have an
   <a href="../../../FeatureSupportByLicense.htm">
    EX license
   </a>
   . Feature Extraction can also be added to an ENVI license at an extra cost. Please contact your
   <span class="DocumentTitleCompanyName">
    Exelis
   </span>
   sales representative for more information.
  </p>
  <h2 class="API">
   Syntax
  </h2>
  <p>
   ENVI_DOIT, 'ENVI_FX_EXAMPLEBASED_DOIT' [,
   <a href="#A_FID">
    A_FID
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#A_POS">
    A_POS
   </a>
   =
   <i>
    array
   </i>
   ] [, /
   <a href="#ALLOW_UN">
    ALLOW_UNCLASSIFIED
   </a>
   ] [,
   <a href="#ATTRIBUT">
    ATTRIBUTE_RASTER_FILENAME
   </a>
   =
   <i>
    string
   </i>
   ] [,
   <a href="#BR_BANDS">
    BR_BANDS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#CLASSIFI">
    CLASSIFICATION_RASTER_FILENAME
   </a>
   =
   <i>
    string
   </i>
   ] [,
   <a href="#CLASSIFI2">
    CLASSIFICATION_THRESHOLD
   </a>
   =
   <i>
    floating point
   </i>
   ] [,
   <a href="#CLASSIFY">
    CLASSIFY_ALGORITHM
   </a>
   =
   <i>
    string
   </i>
   ] [,
   <a href="#CONFIDEN">
    CONFIDENCE_RASTER_IMAGE
   </a>
   =
   <i>
    string
   </i>
   ] [,
   <a href="#CS_BANDS">
    CS_BANDS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#DEGREE">
    DEGREE
   </a>
   =
   <i>
    integer
   </i>
   ] [,
   <a href="#DIMS">
    DIMS
   </a>
   =
   <i>
    array
   </i>
   ]  [, /
   <a href="#DO_AUTO_">
    DO_AUTO_ATTRIBUTE
   </a>
   ] [, /
   <a href="#DO_MERGE">
    DO_MERGE
   </a>
   ] [,
   <a href="#EXAMPLE_">
    EXAMPLE_VECTOR_FILENAME
   </a>
   =
   <i>
    string
   </i>
   ] [, /
   <a href="#EXPORT_V">
    EXPORT_VECTOR_ATTRIBUTES
   </a>
   ],
   <a href="#FID">
    FID
   </a>
   =
   <i>
    file ID
   </i>
   [, /
   <a href="#INVERSE_">
    INVERSE_MASK
   </a>
   ] [,
   <a href="#KERNEL_B">
    KERNEL_BIAS
   </a>
   =
   <i>
    floating point
   </i>
   ] [,
   <a href="#KERNEL_G">
    KERNEL_GAMMA
   </a>
   =
   <i>
    floating point
   </i>
   ] [,
   <a href="#KERNEL_S">
    KERNEL_SIZE
   </a>
   =
   <i>
    long integer
   </i>
   ] [,
   <a href="#KNN_NEIG">
    KNN_NEIGHBORS
   </a>
   =
   <i>
    integer
   </i>
   ] [,
   <a href="#KERNEL_T">
    KERNEL_TYPE
   </a>
   =
   <i>
    string
   </i>
   ] [,
   <a href="#M_FID">
    M_FID
   </a>
   =
   <i>
    file ID
   </i>
   ][,
   <a href="#MERGE_AL">
    MERGE_ALGORITHM
   </a>
   =
   <i>
    string
   </i>
   ] [ ,
   <a href="#MERGE_BA">
    MERGE_BANDS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#MERGE_LE">
    MERGE_LEVEL
   </a>
   =
   <i>
    floating point
   </i>
   ] [,
   <a href="#PENALTY">
    PENALTY
   </a>
   =
   <i>
    floating point
   </i>
   ] [,
   <a href="#POS%C2%A0(opt">
    POS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#R_FID">
    R_FID
   </a>
   =
   <i>
    variable
   </i>
   ] [,
   <a href="#REPORT_F">
    REPORT_FILENAME
   </a>
   =
   <i>
    string
   </i>
   ] [,
   <a href="#SCALE_LE">
    SCALE_LEVEL
   </a>
   =
   <i>
    floating point
   </i>
   ] [,
   <a href="#SEGMENTA">
    SEGMENTATION_ALGORITHM
   </a>
   =
   <i>
    string
   </i>
   ],
   <a href="#SEGMENTA2">
    SEGMENTATION_RASTER_FILENAME
   </a>
   =
   <i>
    string
   </i>
   [,
   <a href="#SEGMENT_">
    SEGMENT_BANDS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#VECTOR_F">
    VECTOR_FILENAME
   </a>
   =
   <i>
    string
   </i>
   ]
  </p>
  <h2 class="API">
   Keywords
  </h2>
  <h3>
   <a name="A_FID">
   </a>
   A_FID (optional)
  </h3>
  <p>
   Set this keyword to an array of file IDs for ancillary data files. Use this keyword in conjunction with the A_POS keyword. The number of elements of A_FID must equal the number of elements of A_POS.
  </p>
  <h3>
   <a name="A_POS">
   </a>
   A_POS (optional)
  </h3>
  <p>
   Set this keyword to an array of long integers representing band numbers to process in the ancillary data files. Use this keyword in conjunction with the A_FID keyword. Specify bands starting with zero (Band 1 = 0, Band 2 = 1, etc.)
  </p>
  <p>
   Each element in the A_POS array corresponds to an element in the A_FID array. For example, suppose you have two ancillary files whose file IDs are 100 and 200. To process Band 1 from file ID 200, and to process Bands 2-5 from file 100, write the code as follows:
  </p>
  <p class="Code_Indented">
   A_FID = [200, 100, 100, 100, 100]
  </p>
  <p class="Code_Indented">
   A_POS = [0, 1, 2, 3, 4]
  </p>
  <p>
   To process all bands from the same file (100), write the code as follows:
  </p>
  <p class="Code_Indented">
   A_FID = [100, 100, 100, 100, 100]
  </p>
  <p class="Code_Indented">
   A_POS = [0, 1, 2, 3, 4]
  </p>
  <h3>
   <a name="ALLOW_UN">
   </a>
   ALLOW_UNCLASSIFIED (optional)
  </h3>
  <p>
   This keyword is set by default to allow segments to be unclassified when the classifier cannot determine suitable classes for them.
  </p>
  <h3>
   <a name="ATTRIBUT">
   </a>
   ATTRIBUTE_RASTER_FILENAME (optional)
  </h3>
  <p>
   Set this keyword to a string with the name of the output attribute image, which is a multi-layer image in
   <a href="../../../ExploreImagery/ENVIImageFiles.htm">
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    raster format
   </a>
   where each layer represents the values of a specific attribute. All attributes are included.
  </p>
  <h3>
   <a name="BR_BANDS">
   </a>
   BR_BANDS (optional)
  </h3>
  <p>
   Set this keyword to a two-element array of long integers that represent bands used to compute an optional Normalized Difference index to use in segmentation. The Normalized Difference index is computed as follows:
  </p>
  <p class="indent">
   [(b2 - b1) / (b2 + b1 + eps)]
  </p>
  <p class="indent" madcap:conditions="">
   Where "eps" is a very small number to avoid division by zero.
  </p>
  <p madcap:conditions="" class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   Set BR_BANDS using the following order: [b1, b2]. Band numbers start with 0.
  </p>
  <p madcap:conditions="">
   If b2 is near-infrared and b1 is red, then
   <b>
    Normalized Difference
   </b>
   will be a measure of normalized difference vegetation index (NDVI).
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   will create a "Normalized Difference" band that you can use for
   <a href="../../../Resources/Snippets/FxSegmentImages.flsnp">
    segmentation
   </a>
   or classification.
  </p>
  <p madcap:conditions="">
   For example, multispectral QuickBird images have the following band definitions:
  </p>
  <table class="TableStyle_Description" style="mc-table-style: url('../../../Resources/TableStyles/Description.css');margin-left: 0;margin-right: auto;" cellspacing="0">
   <col />
   <col style="width: 21px;" />
   <col />
   <thead>
    <tr>
     <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Band number
      </p>
     </th>
     <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Wavelength Center
      </p>
     </th>
     <th class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
      <p>
       Zero-based band number
      </p>
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       1
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      Blue (485 nm)
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       0
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       2
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      Green (560 nm)
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       1
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       3
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      Red (660 nm)
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       2
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
      <p>
       4
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
      <p>
       Near-infrared (830 nm)
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
      <p>
       3
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <p madcap:conditions="">
   To compute NDVI using QuickBird imagery, set BR_BANDS=[2,3].
  </p>
  <h3>
   <a name="CLASSIFI">
   </a>
   CLASSIFICATION_RASTER_FILENAME (optional)
  </h3>
  <p>
   Set this keyword to a string with the name of the output classification image. This type of image is in
   <a href="../../../ExploreImagery/ENVIImageFiles.htm">
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    raster format
   </a>
   , and the pixel vaues represent different classes.
  </p>
  <h3>
   <a name="CLASSIFI2">
   </a>
   CLASSIFICATION_THRESHOLD (optional)
  </h3>
  <p>
   Set this keyword to a floating-point value between 0 and 100, indicating the confidence threshold. See
   <a href="../../../FindFeatures/FeatureExtraction/Example_Based_Classification.htm#Selectin3">
    Select a Classification Method (Advanced)
   </a>
   for more information on the threshold value. The default value is 5.0 (5), which means segments that have less than 5 percent confidence in each class are set to "unclassified."
  </p>
  <h3>
   <a name="CLASSIFY">
   </a>
   CLASSIFY_ALGORITHM (optional)
  </h3>
  <p>
   Set this keyword to a string indicating the supervised classification method to use:
  </p>
  <ul>
   <li value="1">
    <code>
     KNN
    </code>
    : (default) This method classifies segments based on their proximity to neighboring training regions. See
    <a href="../../../FindFeatures/FeatureExtraction/BackgroundKNN.htm">
     Background on K Nearest Neighbor
    </a>
    for more information.
   </li>
   <li value="2">
    <code>
     PCA
    </code>
    : This method assigns segments to classes using a principal components analysis. You must define at least two classes with a minimum of two training regions each. See
    <a href="../../../FindFeatures/FeatureExtraction/BackgroundPCA.htm">
     Background on Principal Components Analysis
    </a>
    for more information.
   </li>
   <li value="3">
    <code>
     SVM
    </code>
    : This is the most rigorous of the three classification methods, so processing time will be slower. See
    <a href="../../../FindFeatures/FeatureExtraction/BackgroundSVM.htm">
     Background on Support Vector Machine
    </a>
    for more information. Each class must have at least two training samples; otherwise, the class will be excluded from classification.
   </li>
  </ul>
  <h3>
   <a name="CONFIDEN">
   </a>
   CONFIDENCE_RASTER_IMAGE (optional)
  </h3>
  <p>
   Set this keyword to a string with the name of the output confidence image. This type of image is in
   <a href="#CONFIDEN">
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    raster format
   </a>
   and shows the relative confidence of each object belonging to a class. The higher the brightness of an object, the higher the confidence that the object belongs to the class. If an object is very dark, it likely does not belong to the class. This is a multi-layer file, with each layer representing one class.
  </p>
  <h3>
   <a name="CS_BANDS">
   </a>
   CS_BANDS (optional)
  </h3>
  <p>
   Set this keyword to a three-element array of long integers that represent the red, green, and blue bands from the input image. Bands are zero-based, so Band 1=0, Band 2=1, etc. These will be used to perform an optional RGB to HSI&#160;color space transformation that will create Hue, Saturation, and Intensity bands to use in segmentation.
  </p>
  <h3>
   <a name="DEGREE">
   </a>
   DEGREE (optional)
  </h3>
  <p>
   This keyword only applies to the SVM classification method. If you set KERNEL_TYPE to POLYNOMIAL, then set DEGREE to an integer value indicating the degree of kernel polynomial. See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundSVM.htm">
    Background on Support Vector Machine
   </a>
   for more information.
  </p>
  <h3>
   <a name="DIMS">
   </a>
   DIMS (optional)
  </h3>
  <p>
   The “dimensions” keyword is a five-element array of long integers that defines the spatial subset (of a file or array) to use for processing. Nearly every time you specify the keyword FID, you must also specify the spatial subset of the corresponding file (even if the entire file, with no spatial subsetting, is to be processed).
  </p>
  <ul>
   <li value="1">
    DIMS[0]: A pointer to an open ROI; use only in cases where ROIs define the spatial subset. Otherwise, set to -1L.
   </li>
   <li value="2">
    DIMS[1]: The starting sample number. The first x pixel is 0.
   </li>
   <li value="3">
    DIMS[2]: The ending sample number
   </li>
   <li value="4">
    DIMS[3]: The starting line number. The first y pixel is 0.
   </li>
   <li value="5">
    DIMS[4]: The ending line number
   </li>
  </ul>
  <p>
   To process an entire file (with no spatial subsetting), define DIMS as shown in the following code example. This example assumes you have already opened a file using
   <a href="../ENVI_S/ENVI_SELECT.htm">
    ENVI_SELECT
   </a>
   or
   <a href="../ENVI_P/ENVI_PICKFILE.htm">
    ENVI_PICKFILE
   </a>
   :
  </p>
  <p class="Code_Indented">
   envi_file_query, fid, dims=dims
  </p>
  <p>
   You
   <i>
    cannot
   </i>
   define DIMS as a pointer to a region of interest (ROI) in any of
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   ’s _DOIT library routines. Using the following example code with a _DOIT library routine will result in an error message when you run the program:
  </p>
  <p class="Code_Indented">
   roi_ids = ENVI_GET_ROI_IDS()
  </p>
  <p class="Code_Indented">
   <br />
   roi_dims = ENVI_GET_ROI_DIMS_PTR(roi_ids[0])
  </p>
  <p class="Code_Indented">
   <br />
   dims= [roi_dims,0,0,0,0]
  </p>
  <h3>
   <a name="DO_AUTO_">
   </a>
   DO_AUTO_ATTRIBUTE (optional)
  </h3>
  <p>
   Set this keyword to have
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   determine the best attributes to use for classifying features. You must define at least two classes with at least two training samples each. The more classes and training samples you have, the slower the process.
  </p>
  <h3>
   <a name="DO_MERGE">
   </a>
   DO_MERGE (optional)
  </h3>
  <p>
   This keyword is set by default to merge adjacent features in the polygon shapefile specified in the VECTOR_FILENAME keyword.
  </p>
  <p>
   Perform merging if you are confident that adjacent polygons belong to the same class and you want to consolidate them into a single polygon. This results in a smaller file size. This option merges all adjacent segments at once across the entire image; you cannot select specific polygons to merge.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   A good example is an angled rooftop that reveals different brightness levels from an aerial sensor, depending on the sun's angle. The segmentation step would typically create multiple regions within the rooftop, each with different spectral values. But if you build a good rule set that identifies rooftops, the classification image (and/or shapefile) will assign these regions to the same class. Since you know that they all belong to one rooftop, you can choose to merge the adjacent segments so that the entire rooftop is one polygon.
  </p>
  <h3>
   <a name="EXAMPLE_">
   </a>
   EXAMPLE_VECTOR_FILENAME (optional)
  </h3>
  <p>
   Set this keyword to a string with the filename of a training data file to import. The training data file must be a point shapefile (
   <code>
    .shp
   </code>
   ). The shapefile contains pixel coordinates of the points where training regions were previously selected in an interactive session of
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   , along with map coordinates if the image is georeferenced.
  </p>
  <p>
   A training data shapefile only contains the locations of training regions; it does not include other parameters you selected for example-based classification such as the classification method, selected attributes, etc.
  </p>
  <h3>
   <a name="EXPORT_V">
   </a>
   EXPORT_VECTOR_ATTRIBUTES
  </h3>
  <p>
   This keyword is set by default to include the spatial, spectral, and texture attributes that were computed for each region, when creating a shapefile of classification results.
  </p>
  <h3>
   <a name="FID">
   </a>
   FID
  </h3>
  <p>
   The file ID (FID) is a long-integer scalar with a value greater than 0. An invalid FID has a value of -1. The FID is provided as a named variable by any routine used to open or select a file. Often, the FID is returned from the keyword R_FID in the
   <a href="../../ENVIRasterToFID.htm">
    ENVIRasterToFID
   </a>
   routine. Files are processed by referring to their FIDs. If you work directly with the file in IDL, the FID is
   <i>
    not
   </i>
   equivalent to a logical unit number (LUN).
  </p>
  <h3>
   <a name="INVERSE_">
   </a>
   INVERSE_MASK (optional)
  </h3>
  <p>
   Set this keyword to invert the mask specified by the M_FID keyword. Inverting the mask means that Feature Extraction will process regions with pixel values of 0 in the mask.
  </p>
  <h3>
   <a name="KERNEL_B">
   </a>
   KERNEL_BIAS (optional)
  </h3>
  <p>
   This keyword only applies to the SVM classification method. Set this keyword to a floating-point value, indicating the bias used in the kernel function. The default value is 1.0. See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundSVM.htm">
    Background on Support Vector Machine
   </a>
   for more information.
  </p>
  <h3>
   <a name="KERNEL_G">
   </a>
   KERNEL_GAMMA (optional)
  </h3>
  <p>
   This keyword only applies to the SVM classification method. Set this keyword to a floating-point value greater than 0.01, indicating the gamma parameter used in the kernel function. The default value is the inverse of the number of computed attributes. See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundSVM.htm">
    Background on Support Vector Machine
   </a>
   for more information.
  </p>
  <h3>
   <a name="KERNEL_S">
   </a>
   KERNEL_SIZE (optional)
  </h3>
  <p>
   Set this keyword to a long-integer odd number representing the size of the kernel used in texture attribute calculations. The default value is 3.
  </p>
  <h3>
   <a name="KERNEL_T">
   </a>
   KERNEL_TYPE (optional)
  </h3>
  <p>
   This keyword only applies to the SVM classification method. Set this keyword to one of the following string values, indicating the kernel type to use. See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundSVM.htm">
    Background on Support Vector Machine
   </a>
   for more information.
  </p>
  <ul>
   <li value="1">
    <code>
     Radial Basis
    </code>
    (default)
   </li>
   <li value="2">
    <code>
     Polynomial
    </code>
   </li>
   <li value="3">
    <code>
     Sigmoid
    </code>
   </li>
  </ul>
  <h3>
   <a name="KNN_NEIG">
   </a>
   KNN_NEIGHBORS (optional)
  </h3>
  <p>
   This keyword only applies to the KNN&#160;classification method. Set this keyword to an odd integer, indicating the number of neighboring training regions to consider in classification. See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundKNN.htm">
    Background on K Nearest Neighbor
   </a>
   for more information.
  </p>
  <h3>
   <a name="M_FID">
   </a>
   M_FID (optional)
  </h3>
  <p>
   Set this keyword to the file ID of a raster mask image. If you specify this keyword, Feature Extraction will ignore regions with pixel values of 0 in the mask.
  </p>
  <h3>
   <a name="MERGE_AL">
   </a>
   MERGE_ALGORITHM (optional)
  </h3>
  <p>
   Set this keyword to one of the following strings, specifying the method used to perform merging:
   <br />
  </p>
  <ul>
   <li value="1">
    <code>
     Full Lambda Schedule
    </code>
    : (default). Merges small segments within larger, textured areas such as trees or clouds, where over-segmentation may be a problem.
   </li>
   <li value="2">
    <code>
     Fast Lambda
    </code>
    : Merges adjacent segments with similar colors and border sizes.
   </li>
  </ul>
  <p>
   See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundMergeAlgorithms.htm">
    Merge Algorithms Background
   </a>
   for more detailed descriptions of each option.
  </p>
  <h3>
   <a name="MERGE_BA">
   </a>
   MERGE_BANDS (optional)
  </h3>
  <p>
   Set this keyword to an array of long integers that represent band numbers to use with the merge algorithm and merge level that you specify. Merging will be based on the differences between region colors on all selected bands. By default, all bands of the input image will be used.
  </p>
  <p>
   If you selected a spectral subset of bands using the
   <a href="#POS%C2%A0(opt">
    POS
   </a>
   keyword, then specify band numbers according to the
   <a href="#POS%C2%A0(opt">
    POS
   </a>
   &#160;array, not the original dataset. For example, suppose that you created a spectral subset of bands 1, 2, 5, and 7 from a 7-band dataset. The POS array for these four bands is [0, 1, 2, 3]. To perform merging on bands 1, 2, and 5 from the original dataset, then use the corresponding POS band numbers as follows:
  </p>
  <p class="Code">
   MERGE_BANDS=[0, 1, 2]
  </p>
  <p>
   If you do not select a spectral subset, then you do not have to keep track of the POS band numbering, as in this example. By default, the MERGE_BANDS keyword will use all bands from the input image.
  </p>
  <h3>
   <a name="MERGE_LE">
   </a>
   MERGE_LEVEL (optional)
  </h3>
  <p>
   Set this keyword to a floating-point value between 0 and 100.0, specifying the merge level used to combine segments with similar colors (Fast Lambda method) or to merge over-segmented areas (Full Lambda Schedule method). The default value is 0.
  </p>
  <h3>
   <a name="PENALTY">
   </a>
   PENALTY (optional)
  </h3>
  <p>
   This keyword only applies to the SVM classification method. Set this keyword to a floating-point value greater than 0.01, indicating the penalty parameter to use. The default value is 100.0. See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundSVM.htm">
    Background on Support Vector Machine
   </a>
   for more information.
  </p>
  <h3>
   <a name="POS (opt">
   </a>
   POS&#160;(optional)
  </h3>
  <p>
   Use this keyword to specify an array of band numbers used to perform segmentation. POS indicates the spectral subset of bands to use in processing. Specify bands starting with zero (Band 1 = 0, Band 2 = 1, etc.)
  </p>
  <p>
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   creates a single dataset  from the combined bands of the input image, ancillary data, normalized difference, hue, saturation, and intensity (if selected). For best results, you should not perform segmentation with a combination of custom bands (normalized difference or HSI color space) and visible/NIR bands. You can perform segmentation on the normalized difference or color space bands by themselves. So in most cases, you will need to select a spectral subset for segmentation instead of using all bands.
  </p>
  <p>
   Specify band numbers in the following order:
  </p>
  <ol>
   <li value="1">
    Input image: one or more bands
   </li>
   <li value="2">
    Ancillary image(s): one or more bands
   </li>
   <li value="3">
    Normalized difference: one band
   </li>
   <li value="4">
    Hue: one band
   </li>
   <li value="5">
    Saturation: one band
   </li>
   <li value="6">
    Intensity: one band
   </li>
  </ol>
  <p>
   For example, if the input image has four bands and you want to perform segmentation on these bands only, set POS = [0, 1, 2, 3].
  </p>
  <p>
   Or, suppose you have a 4-band image and you set the BR_BANDS and CS_BANDS keywords. The band numbers are as follows:
  </p>
  <ul>
   <li value="1">
    Input image: [0, 1, 2, 3]
   </li>
   <li value="2">
    Normalized difference: [4]
   </li>
   <li value="3">
    Hue: [5]
   </li>
   <li value="4">
    Saturation: [6]
   </li>
   <li value="5">
    Intensity: [7]
   </li>
  </ul>
  <p>
   To perform segmentation on the saturation band only, set POS = [6] in this example.
  </p>
  <p>
   For hyperspectral imagery, we strongly recommend that you run a
   <a href="../../../PreprocessImagery/Transforms/PrincipalComponentAnalysis.htm">
    principal components analysis
   </a>
   or
   <a href="../../../PreprocessImagery/Transforms/IndependentComponentsAnalysis.htm">
    independent components analysis
   </a>
   on the dataset before using it in Feature Extraction. Segmentation and merging work best on datasets with only a few bands, plus it helps you keep track of the band numbers when setting the POS&#160;keyword.
  </p>
  <h3>
   <a name="R_FID">
   </a>
   R_FID (optional)
  </h3>
  <p>
   This keyword is a returned variable containing the file ID&#160;of the segmentation image. If processing fails for any reason, then R_FID = -1.
  </p>
  <h3>
   <a name="REPORT_F">
   </a>
   REPORT_FILENAME (optional)
  </h3>
  <p>
   Set this keyword to a string indicating the filename of a text report that lists the segmentation and merge settings used, the input and ancillary files used, a list of attributes that were computed for the segmentation image, and any output files that were created.
  </p>
  <h3>
   <a name="SCALE_LE">
   </a>
   SCALE_LEVEL (optional)
  </h3>
  <p>
   Set this keyword to a floating-point value between 0 and 100.0, indicating the scale level used to delineate features of interest in segmentation. Increasing the value reduces the number of segments. The default value is 50.0 for the Edge segmentation method and 0 for the Intensity method.
  </p>
  <h3>
   <a name="SEGMENTA">
   </a>
   SEGMENTATION_ALGORITHM (optional)
  </h3>
  <p>
   Set this keyword to one of the following strings, indicating the segmentation method to use:
  </p>
  <ul>
   <li value="1">
    <code>
     Edge
    </code>
    (default): Best for detecting edges of features where objects of interest have sharp edges. Set the SCALE_LEVEL and MERGE_LEVEL as needed to best delineate features of interest.
   </li>
   <li value="2">
    <code>
     Intensity
    </code>
    : Best for segmenting images with subtle gradients such as digital elevation models (DEMs) or images of electromagnetic fields. When selecting this method, don't perform any merging; set MERGE_LEVEL=0. Merging is used primarily to combine segments with similar spectral information. Elevation and other related attributes are not appropriate for merging.
   </li>
  </ul>
  <p>
   See
   <a href="../../../FindFeatures/FeatureExtraction/BackgroundSegmentationAlgorithm.htm">
    Watershed Algorithm Background
   </a>
   for more detailed descriptions of each option.
  </p>
  <h3>
   <a name="SEGMENTA2">
   </a>
   SEGMENTATION_RASTER_FILENAME
  </h3>
  <p>
   Set this keyword to a string indicating the filename of the output segmentation image. This is an image in
   <a href="../../../ExploreImagery/ENVIImageFiles.htm">
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    raster format
   </a>
   that shows the regions defined by segmentation; each region is assigned the mean spectral values of all the pixels that belong to that region.
  </p>
  <h3>
   <a name="SEGMENT_">
   </a>
   SEGMENT_BANDS (optional)
  </h3>
  <p>
   Set this keyword to an array of long integers representing the band numbers to use in the segmentation method and scale level that you specify. All bands from the input image are selected by default. The settings will apply to a grayscale image derived from the average of all selected bands.  For best segmentation results, select a combination of bands that have similar spectral ranges such as red, green, blue, and near-infrared bands.
  </p>
  <p>
   If you selected a spectral subset of bands using the
   <a href="#POS%C2%A0(opt">
    POS
   </a>
   keyword, then specify band numbers according to the
   <a href="#POS%C2%A0(opt">
    POS
   </a>
   &#160;array, not the original dataset. For example, suppose that you created a spectral subset of bands 1, 2, 5, and 7 from a 7-band dataset. The POS array for these four bands is [0, 1, 2, 3]. To perform segmentation on bands 1, 2, and 5 from the original dataset, then use the corresponding POS band numbers as follows:
  </p>
  <p class="Code">
   SEGMENT_BANDS=[0, 1, 2]
  </p>
  <p>
   If you do not select a spectral subset, then you do not have to keep track of the POS band numbering, as in this example. By default, the SEGMENT_BANDS keyword will use all bands from the input image.
  </p>
  <h3>
   <a name="VECTOR_F">
   </a>
   VECTOR_FILENAME (optional)
  </h3>
  <p>
   Set this keyword to a string indicating the filename of a polygon shapefile of classification results. If you do not specify this keyword, then no shapefile will be created.
  </p>
  <h2 class="API">
   <a name="Example">
   </a>
   Example
  </h2>
  <p>
   This example uses files that are on the
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   Resource DVD, which is provided with the software installation disk. Go to the
   <code>
    feature_extraction
   </code>
   folder, and copy the files
   <code>
    qb_colorado*.*
   </code>
   to the
   <code>
    data
   </code>
   directory of the
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   installation:
  </p>
  <p>
   <b>
    Windows:
   </b>
   <code>
    C:\Program Files\Exelis\ENVI
    <i>
     xx
    </i>
    \data
   </code>
  </p>
  <p>
   <b>
    Linux:
   </b>
   <![CDATA[ ]]>
   <code>
    /usr/local/exelis/envi
    <i>
     xx
    </i>
    /data
   </code>
  </p>
  <p>
   <b>
    Macintosh:
   </b>
   <![CDATA[ ]]>
   <code>
    Applications/exelis/envi
    <i>
     xx
    </i>
    /data
   </code>
  </p>
  <p>
   This example imports a training data shapefile containing four classes, creates several output files, and displays the resulting classification image.
  </p>
  <p class="Code">
   PRO FX_EXAMPLEBASED_DOIT
  </p>
  <p class="Code_Indented">
   compile_opt IDL2
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Initialize ENVI and send all errors
  </p>
  <p class="Code_Indented">
   ; and warnings to the file batch.txt
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   e = ENVI(/HEADLESS)
  </p>
  <p class="Code_Indented">
   temp_dir = e.GetPreference('TEMPORARY_DIRECTORY')
  </p>
  <p class="Code_Indented">
   e.LOG_FILE = temp_dir+'batch.txt'
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Open the input file
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   file = FILEPATH('qb_colorado.dat', $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;ROOT_DIR=e.ROOT_DIR, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;SUBDIRECTORY = ['data'])
  </p>
  <p class="Code_Indented">
   raster = e.OpenRaster(file)
  </p>
  <p class="Code_Indented">
   fid = ENVIRasterToFID(raster)
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Verify FID is valid
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   IF (FID eq -1) THEN BEGIN
  </p>
  <p class="Code_Indented">
   &#160;&#160;e.Close
  </p>
  <p class="Code_Indented">
   &#160;&#160;RETURN
  </p>
  <p class="Code_Indented">
   ENDIF
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Open training data shapefile
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   training_file = FILEPATH('qb_colorado_examplebased_training.shp', $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;ROOT_DIR=e.ROOT_DIR, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;SUBDIR = ['data'])
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Set output filenames
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   report_filename = temp_dir+'report.txt'
  </p>
  <p class="Code_Indented">
   confidence_raster_filename = temp_dir+'confidence.dat'
  </p>
  <p class="Code_Indented">
   classification_raster_filename = temp_dir+'classes.dat'
  </p>
  <p class="Code_Indented">
   segmentation_raster_filename = temp_dir+'segmentation.dat'
  </p>
  <p class="Code_Indented">
   vector_filename = temp_dir+'classes.shp'
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Set the keywords.
  </p>
  <p class="Code_Indented">
   dims = [-1L, 0, raster.ncolumns-1, 0, raster.nrows-1]
  </p>
  <p class="Code_Indented">
   pos = lindgen(raster.nbands); process all bands
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Perform example-based classification
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   envi_doit, 'envi_fx_examplebased_doit', $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;fid=fid, pos=pos, dims=dims, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;r_fid=r_fid, merge_level=85.0, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;scale_level=50.0, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;br_bands=[2,3], $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;segment_bands=[3], $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;classiication_algorithm='KNN', $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;knn_neighbors=3, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;example_vector_filename=training_file, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;segmentation_raster_filename=segmentation_raster_filename, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;report_filename=report_filename, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;confidence_raster_image=confidence_raster_filename, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;classification_raster_filename=classification_raster_filename, $
  </p>
  <p class="Code_Indented">
   &#160;&#160;&#160;vector_filename=vector_filename&#160;&#160;
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Exit ENVI
  </p>
  <p class="Code_Indented">
   e.Close
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   ; Re-open ENVI in interactive mode and display
  </p>
  <p class="Code_Indented">
   ; the classification image.
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code_Indented">
   e = ENVI()
  </p>
  <p class="Code_Indented">
   raster = e.OpenRaster(classification_raster_filename)
  </p>
  <p class="Code_Indented">
   view = e.GetView()
  </p>
  <p class="Code_Indented">
   layer = view.CreateLayer(raster)
  </p>
  <p class="Code_Indented">
   view.Zoom, /FULL_EXTENT
  </p>
  <p class="Code_Indented">
   ;
  </p>
  <p class="Code">
   END
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>