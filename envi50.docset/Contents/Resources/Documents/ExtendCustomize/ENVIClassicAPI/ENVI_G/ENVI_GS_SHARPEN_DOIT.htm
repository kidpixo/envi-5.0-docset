<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Programming|Routines|Processing" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-us" xml:lang="en-us" madcap:pathtohelpsystem="../../../../" madcap:helpsystemfilename="ENVIHelp.xml" madcap:searchtype="Stem">
 <!-- saved from url=(0014)about:internet -->
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   ENVI_GS_SHARPEN_DOIT
  </title>
  <link href="../../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
  <script src="../../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../../ENVIHelp_CSH.htm#ExtendCustomize/ENVIClassicAPI/ENVI_G/ENVI_GS_SHARPEN_DOIT.htm" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../ProgrammingWithENVI.htm">
    Programming
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../../Routines.htm">
    Routines
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../A/ADAPT_FILT_DOIT.htm">
    Processing
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    ENVI_GS_SHARPEN_DOIT
   </span>
  </div>
  <h1>
   <a name="kanchor712">
   </a>
   ENVI_GS_SHARPEN_DOIT
  </h1>
  <p>
   This procedure performs Gram-Schmidt spectral sharpening, which sharpens a low spatial resolution multispectral image using associated high spatial resolution panchromatic bands. These two datasets are coregistered on the fly if they are both georeferenced. You can specify the low spatial resolution spectral band, or it can be determined from the low spatial resolution multispectral image.
  </p>
  <p>
   Ensure that you have adequate disk space before performing a Gram-Schmidt transformation, because this process creates an output file and several temporary files. An error message will appear during the process if you do not have adequate disk space.
  </p>
  <h2 class="API">
   Syntax
  </h2>
  <p>
   ENVI_DOIT, 'ENVI_GS_SHARPEN_DOIT',
   <a href="#DIMS">
    DIMS
   </a>
   =
   <i>
    array
   </i>
   ,
   <a href="#FID">
    FID
   </a>
   =
   <i>
    file ID
   </i>
   [,
   <a href="#FILTER_FID">
    FILTER_FID
   </a>
   =
   <i>
    variable
   </i>
   ] [,
   <a href="#FILTER_POS">
    FILTER_POS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#HIRES_DIMS">
    HIRES_DIMS
   </a>
   =
   <i>
    array
   </i>
   ],
   <a href="#HIRES_FID">
    HIRES_FID
   </a>
   =
   <i>
    file ID
   </i>
   ,
   <a href="#HIRES_POS">
    HIRES_POS
   </a>
   =
   <i>
    array
   </i>
   , /
   <a href="#IN_MEMORY">
    IN_MEMORY
   </a>
   [,
   <a href="#INTERP">
    INTERP
   </a>
   ={0 | 1 | 2}] [,
   <a href="#LORES_DIMS">
    LORES_DIMS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#LORES_FID">
    LORES_FID
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#LORES_POS">
    LORES_POS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#M_FID">
    M_FID
   </a>
   =
   <i>
    file ID
   </i>
   ] [,
   <a href="#M_POS">
    M_POS
   </a>
   =
   <i>
    array
   </i>
   ] [,
   <a href="#MASK_VALUE">
    MASK_VALUE
   </a>
   =
   <i>
    value
   </i>
   ],
   <a href="#METHOD">
    METHOD
   </a>
   ={0 | 1 | 2 | 3} [,
   <a href="#OUT_BNAME">
    OUT_BNAME
   </a>
   =
   <i>
    string array
   </i>
   ],
   <a href="#OUT_NAME">
    OUT_NAME
   </a>
   =
   <i>
    string
   </i>
   ,
   <a href="#POS">
    POS
   </a>
   =
   <i>
    array
   </i>
   [,
   <a href="#R_FID">
    R_FID
   </a>
   =
   <i>
    file ID
   </i>
   ]
  </p>
  <h2 class="API">
   Keywords
  </h2>
  <h3>
   <a name="DIMS">
   </a>
   DIMS
  </h3>
  <p>
   The “dimensions” keyword is a five-element array of long integers that defines the spatial subset (of a file or array) to use for processing. Nearly every time you specify the keyword FID, you must also specify the spatial subset of the corresponding file (even if the entire file, with no spatial subsetting, is to be processed).
  </p>
  <ul>
   <li value="1">
    DIMS[0]: A pointer to an open ROI; use only in cases where ROIs define the spatial subset. Otherwise, set to -1L.
   </li>
   <li value="2">
    DIMS[1]: The starting sample number. The first x pixel is 0.
   </li>
   <li value="3">
    DIMS[2]: The ending sample number
   </li>
   <li value="4">
    DIMS[3]: The starting line number. The first y pixel is 0.
   </li>
   <li value="5">
    DIMS[4]: The ending line number
   </li>
  </ul>
  <p>
   To process an entire file (with no spatial subsetting), define DIMS as shown in the following code example. This example assumes you have already opened a file using
   <a href="../ENVI_S/ENVI_SELECT.htm">
    ENVI_SELECT
   </a>
   or
   <a href="../ENVI_P/ENVI_PICKFILE.htm">
    ENVI_PICKFILE
   </a>
   :
  </p>
  <p class="Code_Indented">
   envi_file_query, fid, dims=dims
  </p>
  <p>
   You
   <i>
    cannot
   </i>
   define DIMS as a pointer to a region of interest (ROI) in any of
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   ’s _DOIT library routines. Using the following example code with a _DOIT library routine will result in an error message when you run the program:
  </p>
  <p class="Code_Indented">
   roi_ids = ENVI_GET_ROI_IDS()
  </p>
  <p class="Code_Indented">
   <br />
   roi_dims = ENVI_GET_ROI_DIMS_PTR(roi_ids[0])
  </p>
  <p class="Code_Indented">
   <br />
   dims= [roi_dims,0,0,0,0]
  </p>
  <h3>
   <a name="FID">
   </a>
   FID
  </h3>
  <p>
   The file ID (FID) is a long-integer scalar with a value greater than 0. An invalid FID has a value of -1. The FID is provided as a named variable by any routine used to open or select a file. Often, the FID is returned from the keyword R_FID in the
   <a href="../../ENVIRasterToFID.htm">
    ENVIRasterToFID
   </a>
   routine. Files are processed by referring to their FIDs. If you work directly with the file in IDL, the FID is
   <i>
    not
   </i>
   equivalent to a logical unit number (LUN).
  </p>
  <h3>
   <a name="FILTER_FID">
   </a>
   FILTER_FID (optional)
  </h3>
  <p>
   Use this keyword to specify a named variable representing the filter file ID to be used with METHOD=2 or 3. The filter file is in the form of a spectral library and contains the spectral response functions for the bands in a multispectral image. This file is only needed if the functions do not already exist in
   <span class="DocumentTitleProductNameENVIClassic">
    ENVI Classic
   </span>
   .
  </p>
  <h3>
   <a name="FILTER_POS">
   </a>
   FILTER_POS (optional)
  </h3>
  <p>
   Use this keyword to specify a scalar representing the index (position/location) of the filter function in the specified spectral library. If you do not specify a value for FILTER_POS, the default value is 0, and the first filter function in the library is used.
  </p>
  <h3>
   <a name="HIRES_DIMS">
   </a>
   HIRES_DIMS (optional)
  </h3>
  <p>
   Use this keyword to specify the spatial dimensions of the high spatial resolution panchromatic band. HIRES_DIMS is a five-element array of long integers with the following definitions:
  </p>
  <ul>
   <li value="1">
    HIRES_DIMS[0]: A pointer to an open ROI; use only in cases where ROIs define the spatial subset. Otherwise, set to -1L.
   </li>
   <li value="2">
    HIRES_DIMS[1]: The starting sample number. The first x pixel is 0.
   </li>
   <li value="3">
    HIRES_DIMS[2]: The ending sample number
   </li>
   <li value="4">
    HIRES_DIMS[3]: The starting line number. The first y pixel is 0.
   </li>
   <li value="5">
    HIRES_DIMS[4]: The ending line number
   </li>
  </ul>
  <h3>
   <a name="HIRES_FID">
   </a>
   HIRES_FID
  </h3>
  <p>
   Use this keyword to specify the file ID for the high spatial resolution panchromatic file. This value is returned from the keyword R_FID in the
   <a href="../ENVI_O/ENVI_OPEN_FILE.htm">
    ENVI_OPEN_FILE
   </a>
   procedure. FID is a long integer with a value greater than 0. An invalid file ID has a value of -1.
  </p>
  <h3>
   <a name="HIRES_POS">
   </a>
   HIRES_POS
  </h3>
  <p>
   Use this keyword to specify the band position of the high spatial resolution panchromatic band. HIRES_POS is an array of long integers, ranging from 0 to the number of bands minus 1.
  </p>
  <h3>
   <a name="IN_MEMORY">
   </a>
   IN_MEMORY
  </h3>
  <p>
   Set this keyword to specify that output should be stored in memory. If you do not set IN_MEMORY, output will be stored on disk and you must specify OUT_NAME (see below).
  </p>
  <h3>
   <a name="INTERP">
   </a>
   INTERP (optional)
  </h3>
  <p>
   Set this keyword to one of the following values to specify the resampling method:
  </p>
  <ul>
   <li value="1">
    0: Nearest neighbor
   </li>
   <li value="2">
    1: Bilinear interpolation
   </li>
   <li value="3">
    2: Cubic convolution
   </li>
  </ul>
  <p>
   The low spatial resolution images are resampled to the high resolution space using the specified resampling method. The default method is nearest neighbor.
  </p>
  <h3>
   <a name="LORES_DIMS">
   </a>
   LORES_DIMS (optional)
  </h3>
  <p>
   Use this keyword to specify the spatial dimensions of the low spatial resolution spectral band. You must specify LORES_DIMS if METHOD=1. LORES_DIMS is a five-element array of long integers with the following definitions:
  </p>
  <ul>
   <li value="1">
    LORES_DIMS[0]: A pointer to an open ROI; use only in cases where ROIs define the spatial subset. Otherwise, set to -1L.
   </li>
   <li value="2">
    LORES_DIMS[1]: The starting sample number. The first x pixel is 0.
   </li>
   <li value="3">
    LORES_DIMS[2]: The ending sample number
   </li>
   <li value="4">
    LORES_DIMS[3]: The starting line number. The first y pixel is 0.
   </li>
   <li value="5">
    LORES_DIMS[4]: The ending line number
   </li>
  </ul>
  <h3>
   <a name="LORES_FID">
   </a>
   LORES_FID (optional)
  </h3>
  <p>
   Use this keyword to specify the file ID for the low spatial resolution multispectral file. You must specify LORES_FID if METHOD=1. This value is returned from the keyword R_FID in the
   <a href="../ENVI_O/ENVI_OPEN_FILE.htm">
    ENVI_OPEN_FILE
   </a>
   procedure. LORES_FID is a long integer with a value greater than 0. An invalid file ID has a value of -1.
  </p>
  <h3>
   <a name="LORES_POS">
   </a>
   LORES_POS (optional)
  </h3>
  <p>
   Use this keyword to specify the band position of the low spatial resolution spectral band. You must specify LORES_POS if METHOD=1. LORES_POS is an array of long integers, ranging from 0 to the number of bands-1.
  </p>
  <h3>
   <a name="M_FID">
   </a>
   M_FID (optional)
  </h3>
  <p>
   Use this keyword to specify the file ID of the mask file. This value is returned from the keyword R_FID in the
   <a href="../ENVI_O/ENVI_OPEN_FILE.htm">
    ENVI_OPEN_FILE
   </a>
   procedure. M_FID is a long integer with a value greater than 0. An invalid file ID has a value of -1.
  </p>
  <h3>
   <a name="M_POS">
   </a>
   M_POS (optional)
  </h3>
  <p>
   Use this keyword to specify the band position of the mask band. M_POS is a long integer with a value greater than or equal to 0.
  </p>
  <h3>
   <a name="MASK_VALUE">
   </a>
   MASK_VALUE (optional)
  </h3>
  <p>
   Use this keyword to specify the output value for the masked pixels. MASK_VALUE is only used when you specify M_FID and M_POS. The default value is 0.
  </p>
  <h3>
   <a name="METHOD">
   </a>
   METHOD
  </h3>
  <p>
   Use this keyword to specify the method for creating the low spatial resolution simulated panchromatic image. Set METHOD to one of the following values.
  </p>
  <ul>
   <li value="1">
    0: Average all the bands specified by POS to simulate a low resolution simulated panchromatic image
   </li>
   <li value="2">
    1: Use the low spatial resolution spectral band specified by LORES_FID, LORES_DIMS, and LORES_POS. The algorithm assumes that the low spatial resolution spectral bands correspond to the high spatial resolution panchromatic band.
   </li>
   <li value="3">
    2: Create a low spatial resolution simulated panchromatic image using a high spatial resolution panchromatic filter function. If you specify this value, you must use the keyword F_FID. The low spatial resolution spectral bands must fall in the range of the high spatial resolution panchromatic band or they will not be included in the resampling process.
   </li>
   <li value="4">
    3: Create a low spatial resolution simulated panchromatic image using a user-defined filter function. If you specify this value, you must use the F_FID keyword. The low spatial resolution spectral bands must fall in the range of the high spatial resolution panchromatic band or they will not be included in the resampling process.
   </li>
  </ul>
  <h3>
   <a name="OUT_BNAME">
   </a>
   OUT_BNAME (optional)
  </h3>
  <p>
   Use this keyword to specify a string array of output band names.
  </p>
  <h3>
   <a name="OUT_NAME">
   </a>
   OUT_NAME
  </h3>
  <p>
   Use this keyword to specify a string with the output filename for the resulting data. If you set the keyword IN_MEMORY, you do not need to specify OUT_NAME.
  </p>
  <h3>
   <a name="POS">
   </a>
   POS
  </h3>
  <p>
   Use this keyword to specify an array of band positions, indicating the band numbers on which to perform the operation. This keyword indicates the spectral subset of bands to use in processing. POS is an array of long integers, ranging from 0 to the number of bands minus 1. Specify bands starting with zero (Band 1=0, Band 2=1, etc.) For example, to process only Bands 3 and 4 of a multi-band file, POS=[2, 3].
  </p>
  <p>
   POS is typically used with individual files. The example code below for
   <a href="../ENVI_S/ENVI_STATS_DOIT.htm">
    ENVI_STATS_DOIT
   </a>
   illustrates the use of POS for a single file with four bands of data:
  </p>
  <p class="Code_Indented">
   pos=[0,1,2,3]
  </p>
  <p class="Code_Indented">
   <br />
   envi_doit, 'envi_stats_doit', dims=dims, fid=fid, pos=pos, $
  </p>
  <p class="Code_Indented">
   <br />
   comp_flag=3, dmin=dmin, dmax=dmax, mean=mean, stdv=stdv, hist=hist
  </p>
  <p>
   But what if you need to create an output file consisting of data from different bands, each from different files? Library routines such as
   <a href="../C/CF_DOIT.htm">
    CF_DOIT
   </a>
   and
   <a href="../ENVI_L/ENVI_LAYER_STACKING_DOIT.htm">
    ENVI_LAYER_STACKING_DOIT
   </a>
   can accomplish this, but they use the POS keyword differently. Suppose you have four files,
   <code>
    test1
   </code>
   ,
   <code>
    test2
   </code>
   ,
   <code>
    test3
   </code>
   , and
   <code>
    test4
   </code>
   , with corresponding FIDs of
   <code>
    fid1
   </code>
   ,
   <code>
    fid2
   </code>
   ,
   <code>
    fid3
   </code>
   , and
   <code>
    fid4
   </code>
   , respectively. In the following example, you want Band 3 from
   <code>
    test1
   </code>
   in the first position, Band 2 from
   <code>
    test2
   </code>
   in the second position, Band 6 from
   <code>
    test3
   </code>
   in the third position, and Band 4 from
   <code>
    test4
   </code>
   in the fourth position. The code should be as follows:
  </p>
  <p class="Code_Indented">
   fid_array = [fid1,fid2,fid3,fid4]
  </p>
  <p class="Code_Indented">
   <br />
   pos=[2,1,5,3]
  </p>
  <p class="Code_Indented">
   <br />
   envi_doit, 'cf_doit', dims=dims, fid=fid_array
  </p>
  <p class="Code_Indented">
   <br />
   out_name='test_composite_file'
  </p>
  <h3>
   <a name="R_FID">
   </a>
   R_FID (optional)
  </h3>
  <p>
   <span class="DocumentTitleProductNameENVIClassic">
    ENVI Classic
   </span>
   library routines that result in new images also have an R_FID, or “returned FID.” This is simply a named variable containing the file ID to access the processed data. Specifying this keyword saves you the step of opening the new file from disk.
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>