<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-us" xml:lang="en-us" madcap:pathtohelpsystem="../../../../" madcap:helpsystemfilename="ENVIHelp.xml" madcap:searchtype="Stem">
 <!-- saved from url=(0014)about:internet -->
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   Build a New Decision Tree
  </title>
  <link href="../../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../../Resources/TableStyles/Description.css" rel="stylesheet" />
  <link href="../../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
  <script src="../../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../../ENVIHelp_CSH.htm#FindFeatures/Classification/ClassificationTools/BuildingNewDecisionTree.htm" style="">
    Open topic with navigation
   </a>
  </p>
  <h1>
   Build a New Decision Tree
  </h1>
  <p>
   Input data can be from various sources and data types. For example, you can use multispectral data in conjunction with digital elevation data to find pixels with low vegetation and high slopes. You can use georeferenced files that are in different projections with different pixel sizes in a single decision tree and
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   reprojects and resample them on-the-fly.
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   can calculate special variables, such as NDVI, on-the-fly and use them in the expressions.
  </p>
  <p>
   Follow these steps to build a new decision tree:
  </p>
  <ol>
   <li value="1">
    From the Toolbox, select
    <b>
     Classification &gt; Decision Tree &gt; New Decision Tree
    </b>
    . The
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    Decision Tree dialog appears with a single decision node and two classes (leaves).
   </li>
   <li value="2">
    Click
    <b>
     Node 1
    </b>
    . The Edit Decision Properties dialog appears.
   </li>
   <li value="3">
    Enter a node
    <b>
     Name
    </b>
    and an
    <b>
     Expression
    </b>
    (see
    <a href="#Decision">
     Decision Tree Variables and Expressions
    </a>
    ), then click
    <b>
     OK
    </b>
    . The Variable/File Pairings dialog appears.
   </li>
   <li value="4">
    In the Variable/File Pairings dialog, select the variable name. The Select File to Associate with Variable dialog appears.
   </li>
   <li value="5">
    Select the input file or band to associate to the variable.
   </li>
   <li value="6">
    In the
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    Decision Tree dialog, add a new node by right-clicking on a
    <b>
     Class
    </b>
    button and selecting
    <b>
     Add Children
    </b>
    .
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    adds two children below the node and clears the title from the node button.
   </li>
   <li value="7">
    Click the new, blank node button. The Edit Decision Properties dialog appears.
   </li>
   <li value="8">
    Enter node
    <b>
     Name
    </b>
    and an
    <b>
     Expression
    </b>
    , then click
    <b>
     OK
    </b>
    .
   </li>
   <li value="9">
    In the Variable/File Pairings dialog, click on the variable name. The Select File to Associate with Variable dialog appears.
   </li>
   <li value="10">
    Select the input file or band to associate to the variable.
   </li>
   <li value="11">
    Repeat steps 6 through 10, adding as many nodes as necessary.
   </li>
   <li value="12">
    When the tree is finished, select
    <b>
     Options &gt; Execute
    </b>
    from the
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    Decision Tree menu bar.
   </li>
  </ol>
  <h2>
   <a name="Decision">
   </a>
   Decision Tree Variables and Expressions
  </h2>
  <p>
   The expressions used in ENVI’s decision tree classifier are similar to those used in Band Math. They must produce single band output and have a binary result of 0 or 1. The 0 result is sent to the “No” branch and the 1 result is sent to the “Yes” branch of the decision tree.
  </p>
  <p>
   The expressions can include math functions, relational operators, boolean operators, and other IDL functions as shown in the following table.
  </p>
  <table style="caption-side: bottom;margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
   <col />
   <col />
   <thead>
    <tr>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p class="TableHead">
       Category
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
      <p class="TableHead">
       Available Functions
      </p>
     </td>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Basic arithmetic
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       Addition (+), subtraction (-), multiplication (*), and division (/)
      </p>
     </td>
    </tr>
    <tr>
     <td rowspan="3" class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Trigonometric functions
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       sin(x), cos(x), and tan(x)
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       Arcs: asin(x), acos(x), and atan(x)
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       Hyperbolics: sinh(x), cosh(x), and tanh(x)
      </p>
     </td>
    </tr>
    <tr>
     <td rowspan="3" class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Relational and logical operators
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       LT, LE, EQ, NE, GE, GT
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       AND, OR, NOT, XOR
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       maximum (&gt;) and minimum (&lt;)
      </p>
     </td>
    </tr>
    <tr>
     <td rowspan="6" class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Other math functions
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       exponent (^) and natural exponent
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       Natural logarithm: alog(x)
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       Log base 10: alog10(x)
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       Integer rounding: round(x), ceil(x)
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       Square root: sqrt(x)
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
      <p>
       Absolute value: abs(x)
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <p>
   The variables in ENVI’s decision tree classifier refer to a band of data or to a special function that acts on the data. The variable names must be within curly brackets, such as {
   <i>
    variable name
   </i>
   }, or be named b
   <i>
    x
   </i>
   , where
   <i>
    x
   </i>
   is a number, as in band math. If a variable is assigned to a multiband file, the variable must have a subscript, in square brackets, referring to a band number (band numbers are 1 to the number of bands). For example, {pc[2]} refers to band 2 of the file assigned to the variable pc.
  </p>
  <p>
   ENVI’s special variable names do calculations on-the-fly, and use the results in the expression. These special variable names must be within curly brackets and can have numbers or additional text after them. For example, {ndvi1} or {pc_can[1]} are allowed special variable names. The special variable names are listed here:
  </p>
  <ul>
   <li value="1">
    {slope}: The slope calculated from a DEM file.
   </li>
   <li value="2">
    {aspect}: The aspect calculated from a DEM file.
   </li>
   <li value="3">
    {ndvi}: NDVI calculated from file. If the sensor type is set in the header, the bands used to calculate the NDVI are automatically found. If
    <span class="DocumentTitleProductName">
     ENVI
    </span>
    does not know which bands to use, it will prompt you to enter the band numbers.
   </li>
   <li value="4">
    {tascap[n]}: Tasseled Cap transform. The subscript, n, points to which tasseled cap result to use in the expression; for example, for TM data, {tascap[2]} will use the greenness band.
   </li>
   <li value="5">
    {pc[n]}: Principal components. The subscript, n, points to which PC band to use in the expression.
   </li>
   <li value="6">
    {mnf[n]}: Minimum noise fraction. The subscript, n, points to which MNF band to use in the expression.
   </li>
   <li value="7">
    {lpc[n]}: Local principal components. Uses only the surviving pixels in the calculations.
   </li>
   <li value="8">
    {lmnf[n]}: Local minimum noise fraction. Uses only the surviving pixels in the calculations.
   </li>
   <li value="9">
    {mean[n]}: The mean for band n.
   </li>
   <li value="10">
    {stdev[n]}: The standard deviation for band n.
   </li>
   <li value="11">
    {min[n]}: The minimum of band n.
   </li>
   <li value="12">
    {max[n]}: The maximum of band n.
   </li>
   <li value="13">
    {lmean[n]}: Local mean. The mean of only the surviving pixels.
   </li>
   <li value="14">
    {lstdev[n]}: Local standard deviation. The standard deviation of only the surviving pixels.
   </li>
   <li value="15">
    {lmin[n]}: Local minimum. The minimum of only the surviving pixels.
   </li>
   <li value="16">
    {lmax[n]}: Local maximum. The maximum of only the surviving pixels.
   </li>
  </ul>
  <p>
   You can use any number of different expressions within the decision tree classifier as long as the expression results in a single, binary decision (true or false answer for each pixel). The following examples show how to define various simple and complex decisions:
  </p>
  <ul>
   <li value="1">
    <p>
     Pixels with values greater than 20 in band 1, and values less than or equal to 45 in band 2 are identified by the following expression:
    </p>
    <pre>
     (b1 GT 20) AND (b2 LE 45)
    </pre>
   </li>
   <li value="2">
    <p>
     Pixels with NDVI (Normalized Difference Vegetation Index) values greater than or equal to 0.3 are identified by the following expression:
    </p>
    <pre>
     {ndvi} GE 0.3
    </pre>
   </li>
   <li value="3">
    <p>
     Pixels with values in band 1 greater than the mean of band 2 plus twice the standard deviation of band 2 are identified by the following expression:
    </p>
    <pre>
     b1 GT ({mean[2]} + 2*{stdev[2]})
    </pre>
   </li>
   <li value="4">
    <p>
     Pixels with a slope greater than 15 degrees and a northern aspect are identified by the following expression:
    </p>
    <pre>
     ({slope} GT 15) AND (({aspect} LT 90) or ({aspect} GT 270))
    </pre>
   </li>
  </ul>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The local statistics variables can only be used on georeferenced files that have the same projection as the selected base file, otherwise statistics are calculated using the entire band.
  </p>
  <h3>
   Use IDL Functions in Node Expressions
  </h3>
  <p>
   The
   <b>
    Expression
   </b>
   field also accepts user-defined functions written in IDL. Derive and apply these functions as expressions in the same manner as user-defined functions in the Band Math and Spectral Math tools. However, the result of the overall expression must still equal 0 or 1.
  </p>
  <p>
   Because ENVI&#160;+&#160;IDL provides access to IDL’s capabilities, you can use the power of built-in IDL features, IDL user functions, or write your own decision tree expressions to perform custom operations. These functions are required to accept one or more pixel variables as input. Moreover, the overall expression must equal 0, 1, or a binary array (of the same spatial size as the input data) in which each pixel value is 0 or 1. Save the functions in a directory that is within the IDL path list (for example, the
   <code>
    save_add
   </code>
   directory in the
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   distribution) so that
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   auto-compiles them.
  </p>
  <h4>
   Example Custom Decision Tree Functions
  </h4>
  <p>
   This example function returns a mask (byte array) where the specified values in the input data are set to 1 and all other pixels are set to 0:
  </p>
  <pre>
   FUNCTION dt_choose_values, data, values
  </pre>
  <pre>
   &#160;
  </pre>
  <pre>
   info = SIZE(data)
  </pre>
  <pre>
   result = MAKE_ARRAY(/BYTE, SIZE = info)
  </pre>
  <pre>
   FOR index = 0L, (N_ELEMENTS(values) - 1) DO $
  </pre>
  <pre>
   &#160;&#160;&#160;result += (data EQ values[index])
  </pre>
  <pre>
   &#160;
  </pre>
  <pre>
   RETURN, result
  </pre>
  <pre>
   END
  </pre>
  <p>
   To call this function from the
   <b>
    Expression
   </b>
   field to derive a mask for values of 20, 22, 24, and 26 in the first band (
   <code>
    b1
   </code>
   ) in the
   <code>
    bhtmref.img
   </code>
   file in the
   <code>
    data
   </code>
   directory of the
   <span class="DocumentTitleProductName">
    ENVI
   </span>
   distribution, use the following syntax:
  </p>
  <pre>
   dt_choose_values(b1, [20, 22, 24, 26])
  </pre>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>